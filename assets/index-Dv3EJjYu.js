import{u as D,g as I,r as n,a as B,G as g,j as t,M as w,T as C,t as p,b as E,c as L,d as m,e as x,I as f,B as y,h as b,S as M}from"./index-DQhiMY92.js";import{C as O,T as k}from"./container-DgOy5ih7.js";import{S as _,D as T,a as U}from"./data-table-Bf3Z-emy.js";import{F as R,C as F}from"./FormControlLabel-C3LMTpmZ.js";import"./TableRow-y31GHlUn.js";import"./TableCell-BU-URHjZ.js";function N(e,u,s,r,o){const[a,d]=n.useState(()=>o&&s?s(e).matches:r?r(e).matches:u);return B(()=>{let c=!0;if(!s)return;const i=s(e),h=()=>{c&&d(i.matches)};return h(),i.addListener(h),()=>{c=!1,i.removeListener(h)}},[e,s]),a}const S=n.useSyncExternalStore;function Q(e,u,s,r,o){const a=n.useCallback(()=>u,[u]),d=n.useMemo(()=>{if(o&&s)return()=>s(e).matches;if(r!==null){const{matches:l}=r(e);return()=>l}return a},[a,e,r,o,s]),[c,i]=n.useMemo(()=>{if(s===null)return[a,()=>()=>{}];const l=s(e);return[()=>l.matches,j=>(l.addListener(j),()=>{l.removeListener(j)})]},[a,s,e]);return S(i,c,d)}function W(e,u={}){const s=D(),r=typeof window<"u"&&typeof window.matchMedia<"u",{defaultMatches:o=!1,matchMedia:a=r?window.matchMedia:null,ssrMatchMedia:d=null,noSsr:c=!1}=I({name:"MuiUseMediaQuery",props:u,theme:s});let i=typeof e=="function"?e(s):e;return i=i.replace(/^@media( ?)/m,""),(S!==void 0?Q:N)(i,o,a,d,c)}const G=e=>n.createElement("svg",{width:36,height:36,viewBox:"0 0 36 36",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},n.createElement("rect",{width:36,height:36,rx:4,fill:"#2A2A32"}),n.createElement("path",{d:"M23.06 13.0474C21.6772 11.6369 19.7503 10.7617 17.619 10.7617C13.4111 10.7617 10 14.1728 10 18.3807C10 22.5885 13.4111 25.9996 17.619 25.9996C20.8887 25.9996 23.6773 23.94 24.7582 21.0473",stroke:"white",strokeWidth:1.5}),n.createElement("path",{d:"M26 16.0952H19.9048L26 10V16.0952Z",fill:"white"})),V=e=>n.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.9365 6.83512L16.0573 5.72584L18.2711 7.91696L17.1504 9.02623L14.9365 6.83512ZM13.8704 7.89035L5.84206 15.8363L5.57349 18.402L8.05076 18.0325L16.0842 10.0815L13.8704 7.89035ZM17.6632 10.6292L8.97809 19.2252C8.83461 19.3672 8.64962 19.4598 8.44996 19.4896L5.09272 19.9903C4.47858 20.0819 3.94309 19.5694 4.00774 18.9518L4.37067 15.4848C4.39352 15.2665 4.49124 15.0628 4.64722 14.9085L15.389 4.2768C15.7592 3.9104 16.3554 3.9104 16.7256 4.2768L19.7213 7.24175C20.0969 7.61353 20.0969 8.22039 19.7213 8.59216L17.6925 10.6001C17.6896 10.6032 17.6866 10.6062 17.6836 10.6093C17.6769 10.616 17.6701 10.6227 17.6632 10.6292Z",fill:"#7D7D87"}));var v=(e=>(e.deleteUserFromOrg="DeleteUserFromOrg",e.inviteToOrg="InviteToOrg",e.deleteInviteFromOrg="DeleteInviteFromOrg",e.updateInviteToOrg="UpdateInviteInOrg",e.updateOrganization="UpdateOrganization",e.updateUserInOrg="UpdateUserInOrg",e.listUsersInOrg="ListUsersInOrg",e.getImageVersions="GetImageVersions",e.approveInvite="ApproveInvite",e.listCluster="ListClusters",e.createCluster="CreateCluster",e.deleteCluster="DeleteCluster",e.updateCluster="UpdateCluster",e.listExtensions="ListExtensions",e.createExtension="CreateExtension",e.deleteExtension="DeleteExtension",e.installExtension="InstallExtension",e.uninstallExtension="UninstallExtension",e))(v||{});const Z=({bucket:e,open:u,setOpen:s})=>{const[r,o]=n.useState(!1),[a,d]=n.useState(!1),{removeBucket:c}=n.useContext(g).buckets,i=()=>{o(!0),c(e),s(!1),o(!1)};return t.jsxs(w,{id:"delete-bucket-modal",title:`Delete bucket ${e==null?void 0:e.name}`,open:u,submitButtonColor:"error",submitButtonLabel:"Delete",cancelButtonDisabled:r,submitButtonDisabled:!a||r,onClose:()=>{d(!1),s(!1)},onSubmit:()=>{i()},loading:r,children:[t.jsx(C,{variant:"body2",color:"text.secondary",sx:{mb:p.spacing(3)},children:"The bucket will be permanently deleted. Are you sure you want to do this?"}),t.jsx(R,{sx:{maxWidth:"100%","& > span":{maxWidth:"100%"}},control:t.jsx(F,{id:"confirm-delete",disabled:r,checked:a,value:a,onChange:h=>d(h.target.checked)}),label:t.jsx(E,{variant:"body2",sx:{maxWidth:"100%",pr:p.spacing(4)},children:`I confirm delete this bucket "${e==null?void 0:e.name}"`})})]})},z=({buckets:e=[],fetchBuckets:u,onCreateClick:s})=>{const{permissions:{canPerformAction:r}}=n.useContext(g),[o,a]=n.useState({}),[d,c]=n.useState(!1),{formatMessage:i}=L();W(l=>l.breakpoints.up("lg"));const h=l=>{a(l),c(!0)};return t.jsxs(t.Fragment,{children:[t.jsx(O,{children:t.jsxs(m,{container:!0,direction:"column",flexWrap:"nowrap",id:"buckets-list",children:[t.jsxs(m,{container:!0,alignItems:"center",justifyContent:"space-between",children:[t.jsx(C,{variant:"h2",id:"buckets-list-header",children:i({id:"bucket_list.title",defaultMessage:"Virtual buckets"},{count:e.length})}),t.jsxs(m,{children:[t.jsx(x,{title:i({id:"bucket_list.reload_list_tooltip",defaultMessage:"Refersh bucket list"}),children:t.jsx(f,{color:"primary","aria-label":"upload picture",component:"span",sx:{p:0},onClick:()=>u(),children:t.jsx(G,{width:36,height:36})})}),t.jsx(x,{title:r(v.createBucket)?"":i({id:"bucket_list.create_bucket_no_permissions",defaultMessage:"Insufficient permissions"}),children:t.jsx("span",{children:t.jsxs(y,{variant:"contained",sx:{ml:p.spacing(2)},onClick:s,disabled:!r(v.createBucket),children:[t.jsx(_,{width:20,height:20}),t.jsx(C,{variant:"button",sx:{ml:p.spacing(1)},children:i({id:"bucket_list.create_bucket_cta",defaultMessage:"Create"})})]})})})]})]}),t.jsx("br",{}),t.jsx(T,{id:"buckets-table",columns:{name:{title:"Name",width:250},description:{title:"Description"},created_at:{title:"Created",width:200},updated_at:{title:"Updated",width:200},accessed_at:{title:"Accessed",width:200}},rows:e,renderNoRows:()=>"No buckets created yet.",renderCell:{created_at:l=>b(l).calendar(),updated_at:l=>b(l).calendar(),accessed_at:l=>b(l).calendar()},renderActions:l=>t.jsxs(m,{container:!0,justifyContent:"space-between",children:[t.jsx(x,{title:"Rename",placement:"left-start",children:t.jsx(f,{className:"rename-bucket-button",sx:{p:p.spacing(.25)},onClick:()=>{},children:t.jsx(V,{})})}),t.jsx(x,{title:"Remove",placement:"right-start",children:t.jsx(f,{className:"remove-bucket-button",sx:{p:p.spacing(.25)},onClick:()=>h(l),children:t.jsx(U,{})})})]})})]})}),t.jsx(Z,{bucket:o,open:d,setOpen:c})]})},H=({open:e,setOpen:u})=>{const{createBucket:s}=n.useContext(g).buckets,[r,o]=n.useState(!1),[a,d]=n.useState(""),[c,i]=n.useState(""),h=()=>{o(!0),s({name:a,id:"",description:c,createdAt:Date(),provider:""}),o(!1),u(!1)};return t.jsxs(w,{id:"rename-cluster-modal",title:"Create bucket",open:e,submitButtonLabel:"Create",cancelButtonDisabled:r,submitButtonDisabled:r||!a.length,onClose:()=>u(!1),onSubmit:()=>h(),loading:r,children:[t.jsx(k,{id:"new-name",error:!a.length,helperText:!a.length&&"Name is required",variant:"filled",value:a,onChange:l=>d(l.target.value),label:"Bucket name",fullWidth:!0}),t.jsx(k,{id:"new-description",error:!c.length,helperText:!c.length&&"Description is required",variant:"filled",value:c,onChange:l=>i(l.target.value),label:"Description",fullWidth:!0})]})},A=()=>{const{orgs:{activeOrgId:e},buckets:{buckets:u,isLoading:s,fetchBuckets:r}}=n.useContext(g),[o,a]=n.useState(!1);return n.useState(null),n.useState(!1),L(),s?t.jsx(M,{noSidebar:!0}):t.jsxs(t.Fragment,{children:[t.jsx(z,{buckets:u,fetchBuckets:r,onCreateClick:()=>a(!0)}),t.jsx(H,{open:o,setOpen:a})]})};export{A as default};
