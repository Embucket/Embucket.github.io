import{j as e,M as S,aL as _,T as C,r,c as k,t as a,d as o,e as E,J as v,aM as m,aN as B,I as T,L as f,aO as I,aA as D,aP as M,aQ as P,aR as L,aS as Z,aT as q,B as j,F as H}from"./index-xBO09GKd.js";import{T as y,C as O}from"./container-Beweolru.js";const V=({modalOpen:t,setModalOpen:p})=>e.jsx(S,{id:"cancel-changes-modal",title:"Cancel changes",open:t,submitButtonLabel:"Confirm",submitButtonColor:"error",onClose:()=>p(!1),onSubmit:()=>_("/"),children:e.jsx(C,{variant:"body2",color:"text.secondary",children:"All unsaved changes would be lost on cancellation, please confirm to continue."})}),A=t=>r.createElement("svg",{width:12,height:12,viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1 5.99793C1 3.23765 3.23765 1 5.99793 1C8.75821 1 10.9959 3.23765 10.9959 5.99793C10.9959 8.75821 8.75821 10.9959 5.99793 10.9959C3.23765 10.9959 1 8.75821 1 5.99793ZM5.99793 0C2.68537 0 0 2.68537 0 5.99793C0 9.3105 2.68537 11.9959 5.99793 11.9959C9.3105 11.9959 11.9959 9.3105 11.9959 5.99793C11.9959 2.68537 9.3105 0 5.99793 0ZM6.4101 7.37208V8.19676H5.58541V7.37208H6.4101ZM4.34837 4.89801C4.34837 3.98672 5.08647 3.24863 5.99775 3.24863C6.90903 3.24863 7.64713 3.98672 7.64713 4.89801C7.64713 5.42701 7.32137 5.71169 7.00419 5.98888C6.70328 6.25184 6.4101 6.50806 6.4101 6.95973H5.58541C5.58541 6.20874 5.97388 5.91097 6.31544 5.64916C6.58338 5.44379 6.82244 5.26055 6.82244 4.89801C6.82244 4.44443 6.45133 4.07332 5.99775 4.07332C5.54417 4.07332 5.17306 4.44443 5.17306 4.89801H4.34837Z",fill:"#7D7D87"})),N=t=>r.createElement("svg",{width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},r.createElement("circle",{cx:8,cy:8,r:8,fill:"#34A853"}),r.createElement("path",{d:"M12 6L7 11L4 8",stroke:"white",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"})),F=t=>r.createElement("svg",{width:20,height:21,viewBox:"0 0 20 21",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},r.createElement("circle",{cx:10,cy:10.5,r:9,fill:"#2A2A32",stroke:"#7D7D87",strokeWidth:2})),R=({password:t="",minPassLength:p=v.MIN_PASS_LENGTH,sx:c})=>{const[g,x]=r.useState(t.length);r.useEffect(()=>{x(w())},[t]);const{formatMessage:n}=k(),w=()=>{let h=0;return t.length>=p?h+=100:h+=Math.floor(100/p*t.length),h},i={blank:{label:n({id:"password_strength.blank_long",defaultMessage:"Password is blank"}),shortLabel:n({id:"password_strength.blank_short",defaultMessage:"Blank"}),scoreThreshold:0,color:a.palette.text.secondary},weak:{label:n({id:"password_strength.weak_long",defaultMessage:"Password must contain 12 symbols minimum"}),shortLabel:n({id:"password_strength.weak_short",defaultMessage:"Weak"}),scoreThreshold:50,color:a.palette.error.main},strong:{label:n({id:"password_strength.strong_long",defaultMessage:"Password is strong"}),shortLabel:n({id:"password_strength.strong_short",defaultMessage:"Strong"}),scoreThreshold:100,color:a.palette.success.main}},s=()=>g===i.blank.scoreThreshold?i.blank:g<i.strong.scoreThreshold?i.weak:i.strong;return e.jsxs(o,{sx:c,children:[e.jsx(o,{sx:{background:a.palette.background.underline},children:e.jsx(o,{sx:{width:`${g}%`,height:"4px",background:s().color,mb:a.spacing(.5)}})}),e.jsxs(o,{container:!0,justifyContent:"space-between",width:"100%",children:[e.jsx(C,{variant:"caption",color:"text.secondary",id:"password-strength",children:s().label}),e.jsxs(o,{container:!0,alignItems:"center",width:"auto",children:[e.jsx(C,{variant:"caption",color:s().color,sx:{mr:a.spacing(1)},id:"password-strength-label",children:s().shortLabel}),e.jsx(E,{componentsProps:{tooltip:{sx:{bgcolor:"background.default",boxShadow:"0px 3px 1px 0px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)","& .MuiTooltip-arrow":{color:"background.paper"}}}},title:e.jsxs(o,{container:!0,direction:"column",sx:{maxWidth:"100%",width:"304px",p:a.spacing(.5)},children:[e.jsxs(o,{container:!0,direction:"row",justifyContent:"space-between",sx:{mb:a.spacing(1)},children:[e.jsx(C,{variant:"body2",children:n({id:"password_strength.title",defaultMessage:"Password Strength"})}),e.jsx(C,{variant:"body2",color:s().color,children:s().shortLabel})]}),e.jsx(o,{sx:{background:a.palette.background.underline,height:"4px",mb:a.spacing(2)},children:e.jsx(o,{sx:{width:`${g}%`,height:"4px",background:s().color,mb:a.spacing(.5)}})}),e.jsx(C,{variant:"overline",color:"text.secondary",children:n({id:"password_strength.password_rules.base",defaultMessage:"Password must contain:"})}),e.jsx(o,{container:!0,direction:"column",sx:{mt:a.spacing(1)},children:e.jsxs(o,{container:!0,sx:{mb:a.spacing(1)},children:[t.length>=p?e.jsx(N,{width:"20",height:"20"}):e.jsx(F,{}),e.jsx(C,{variant:"body2",sx:{ml:a.spacing(2)},children:n({id:"password_strength.password_rules.min_symbols",defaultMessage:"12 symbols minimum"})})]})})]}),placement:"right",children:e.jsx(o,{sx:{cursor:"pointer"},children:e.jsx(A,{})})})]})]})]})},W=t=>r.createElement("svg",{width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},r.createElement("path",{d:"M17.25 10C17.25 9.97924 17.2469 10.0589 17.1638 10.2694C17.0893 10.4579 16.9714 10.6998 16.8071 10.9784C16.4788 11.5351 15.986 12.2033 15.3447 12.8447C14.0571 14.1323 12.2367 15.25 10 15.25V16.75C12.7633 16.75 14.9429 15.3677 16.4053 13.9053C17.139 13.1717 17.7087 12.4024 18.0991 11.7404C18.2942 11.4096 18.4498 11.0968 18.5589 10.8204C18.6594 10.5661 18.75 10.2708 18.75 10H17.25ZM10 15.25C7.76332 15.25 5.94292 14.1323 4.65533 12.8447C4.01398 12.2033 3.52121 11.5351 3.1929 10.9784C3.02859 10.6998 2.91069 10.4579 2.83624 10.2694C2.75311 10.0589 2.75 9.97924 2.75 10H1.25C1.25 10.2708 1.34064 10.5661 1.44111 10.8204C1.55024 11.0968 1.70578 11.4096 1.90085 11.7404C2.29129 12.4024 2.86102 13.1717 3.59467 13.9053C5.05708 15.3677 7.23668 16.75 10 16.75V15.25ZM2.75 10C2.75 10.0208 2.75311 9.94106 2.83624 9.73059C2.91069 9.54206 3.02859 9.30022 3.1929 9.02161C3.52121 8.46491 4.01398 7.79668 4.65533 7.15533C5.94292 5.86774 7.76332 4.75 10 4.75V3.25C7.23668 3.25 5.05708 4.63226 3.59467 6.09467C2.86102 6.82832 2.29129 7.59759 1.90085 8.25964C1.70578 8.5904 1.55024 8.90325 1.44111 9.17957C1.34064 9.43394 1.25 9.72924 1.25 10H2.75ZM10 4.75C12.2367 4.75 14.0571 5.86774 15.3447 7.15533C15.986 7.79668 16.4788 8.46491 16.8071 9.02161C16.9714 9.30022 17.0893 9.54206 17.1638 9.73059C17.2469 9.94106 17.25 10.0208 17.25 10H18.75C18.75 9.72924 18.6594 9.43394 18.5589 9.17957C18.4498 8.90325 18.2942 8.5904 18.0991 8.25964C17.7087 7.59759 17.139 6.82832 16.4053 6.09467C14.9429 4.63226 12.7633 3.25 10 3.25V4.75Z",fill:"#7D7D87"}),r.createElement("circle",{cx:10,cy:10,r:3,stroke:"#7D7D87",strokeWidth:1.5})),$=t=>r.createElement("svg",{width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16.6594 13.5887C17.2476 12.9538 17.7138 12.3078 18.0484 11.7405C18.2434 11.4097 18.399 11.0969 18.5081 10.8205C18.6086 10.5662 18.6992 10.2709 18.6992 10.0001C18.6992 9.72935 18.6086 9.43406 18.5081 9.17968C18.399 8.90336 18.2434 8.59052 18.0484 8.25975C17.6579 7.59771 17.0882 6.82843 16.3545 6.09478C14.8921 4.63238 12.7125 3.25011 9.94922 3.25011C8.8378 3.25011 7.82081 3.47372 6.90693 3.83621L8.08676 5.01604C8.6696 4.84679 9.2914 4.75011 9.94922 4.75011C12.1859 4.75011 14.0063 5.86785 15.2939 7.15544C15.9352 7.79679 16.428 8.46502 16.7563 9.02173C16.9206 9.30033 17.0385 9.54218 17.113 9.7307C17.1758 9.88984 17.1929 9.97422 17.1975 9.99694L17.1982 10.0001L17.1975 10.0033C17.1929 10.026 17.1758 10.1104 17.113 10.2695C17.0385 10.4581 16.9206 10.6999 16.7563 10.9785C16.4819 11.4438 16.0927 11.9869 15.5979 12.5271L16.6594 13.5887ZM13.6541 10.5834C13.6838 10.3933 13.6992 10.1985 13.6992 10.0001C13.6992 7.92905 12.0203 6.25011 9.94922 6.25011C9.75081 6.25011 9.556 6.26552 9.36593 6.29521L11.2007 8.13002C11.4451 8.29384 11.6555 8.50428 11.8193 8.7486L13.6541 10.5834ZM3.00993 1.9395L3.00988 1.93945L1.94922 3.00011L4.32939 5.38029C4.04827 5.6123 3.78623 5.85244 3.54389 6.09478C2.81024 6.82843 2.2405 7.59771 1.85007 8.25975C1.655 8.59052 1.49946 8.90336 1.39033 9.17968C1.28986 9.43406 1.19922 9.72935 1.19922 10.0001C1.19922 10.2709 1.28986 10.5662 1.39033 10.8205C1.49946 11.0969 1.655 11.4097 1.85007 11.7405C2.2405 12.4025 2.81024 13.1718 3.54389 13.9054C5.0063 15.3679 7.1859 16.7501 9.94922 16.7501C11.6715 16.7501 13.1671 16.2131 14.4036 15.4545L16.7985 17.8494L17.7986 16.8492L2.94941 2.00002L3.00993 1.9395ZM13.3072 14.3581L12.0536 13.1045C11.4536 13.512 10.7292 13.7501 9.94922 13.7501C7.87815 13.7501 6.19922 12.0712 6.19922 10.0001C6.19922 9.22013 6.43735 8.49577 6.84487 7.89576L5.39546 6.44635C5.11312 6.67225 4.84921 6.91078 4.60455 7.15544C3.9632 7.79679 3.47043 8.46502 3.14212 9.02173C2.97781 9.30033 2.85991 9.54218 2.78545 9.7307C2.7226 9.88985 2.70549 9.97422 2.70089 9.99694L2.70024 10.0001L2.70089 10.0033C2.70549 10.026 2.7226 10.1104 2.78545 10.2695C2.85991 10.4581 2.97781 10.6999 3.14212 10.9785C3.47043 11.5352 3.9632 12.2034 4.60455 12.8448C5.89214 14.1324 7.71254 15.2501 9.94922 15.2501C11.2071 15.2501 12.3334 14.8966 13.3072 14.3581ZM10.96 12.0109L7.93847 8.98937C7.78541 9.29327 7.69922 9.63663 7.69922 10.0001C7.69922 11.2428 8.70658 12.2501 9.94922 12.2501C10.3127 12.2501 10.6561 12.1639 10.96 12.0109Z",fill:"#7D7D87"})),U=m().min(v.MIN_PASS_LENGTH,`Password must be at least ${v.MIN_PASS_LENGTH} characters long`).required("Password is required").test("Must contain only ascii characters","Password cannot contain invalid characters.",t=>!/[^\x21-\x7e]/g.test(t)),G=m().required("Confirm password is required").oneOf([B("password"),null],"Passwords must match"),b=({id:t,name:p,value:c,label:g,onChange:x,error:n="",touched:w=!1,disabled:i=!1,showStrength:s=!1,sx:h={}})=>{const[u,d]=r.useState(!1);return e.jsxs(o,{sx:{position:"relative",...h},children:[e.jsx(y,{fullWidth:!0,variant:"filled",id:t,name:p,label:g,type:u?"text":"password",autoComplete:"new-password",value:c,onChange:x,disabled:i,error:w&&!!n,helperText:w&&n,sx:{mb:a.spacing(1)}}),e.jsx(T,{id:`${t}-show`,sx:{position:"absolute",right:a.spacing(1.5),top:a.spacing(1.5)},onClick:()=>d(!u),tabIndex:-1,children:u?e.jsx($,{}):e.jsx(W,{})}),s&&e.jsx(R,{password:c})]})},z=({modalOpen:t,setModalOpen:p})=>{const[c,g]=r.useState(!1),x=f(I),n=f(D),w=M(),i={oldPassword:"",password:"",repeatPassword:""},s=P({initialValues:i,validationSchema:L({oldPassword:m().required("Current password is required"),password:U,repeatPassword:G}),onSubmit:h=>{g(!0),x.updatePassword(h).then(()=>{n.show("Please signin again.","success","Password changed!"),w("/auth/signin")}).catch(u=>{var d,l;g(!1),((d=u==null?void 0:u.response)==null?void 0:d.status)>=400&&((l=u==null?void 0:u.response)==null?void 0:l.status)<500?s.setErrors({oldPassword:"Invalid password"}):n.showDefaultError()})}});return e.jsxs(S,{id:"change-password-modal",title:"Change password",open:t,submitButtonLabel:"Confirm changing password",submitButtonDisabled:c,cancelButtonDisabled:c,loading:c,onClose:()=>{s.resetForm({values:i}),p(!1)},onSubmit:()=>s.submitForm(),children:[e.jsx(b,{id:"oldPassword",name:"oldPassword",value:s.values.oldPassword,onChange:s.handleChange,error:s.errors.oldPassword,touched:s.touched.oldPassword,disabled:c,label:"Current password",sx:{mb:a.spacing(2)}}),e.jsx(b,{id:"password",name:"password",value:s.values.password,onChange:s.handleChange,error:s.errors.password,touched:s.touched.password,disabled:c,label:"New password",sx:{mb:a.spacing(2)},showStrength:!0}),e.jsx(b,{id:"repeatPassword",name:"repeatPassword",value:s.values.repeatPassword,onChange:s.handleChange,error:s.errors.repeatPassword,touched:s.touched.repeatPassword,disabled:c,label:"Repeat new password"})]})},K=()=>{const t=M(),[p,c]=r.useState(!1),[g,x]=r.useState(!1),[n,w]=r.useState(!1),{profile:i}=r.useContext(Z),s={first_name:i.given_name||"",last_name:i.family_name||"",email:i.email||""},h={first_name:{label:"First name",type:"text",disabled:!0},last_name:{label:"Last name",type:"text",disabled:!0},email:{label:"Email",type:"text",disabled:!0}},u=L({first_name:m().required("First name is required"),last_name:m().required("Last name is required"),email:m().email("Must be a valid email").required("Email is required")}),d=P({initialValues:s,validationSchema:u,onSubmit:()=>{}});return e.jsxs(O,{children:[e.jsx(o,{sx:{width:"100%","> div":{paddingBottom:a.spacing(9)}},children:e.jsxs(o,{container:!0,direction:"column",children:[e.jsx(C,{variant:"h2",children:"User profile"}),e.jsxs(o,{container:!0,sx:{mt:a.spacing(4),flexWrap:"nowrap"},children:[e.jsx(q,{name:i.name,sx:{width:"72px",height:"72px",mr:a.spacing(2)}}),e.jsx("form",{onSubmit:d.handleSubmit,style:{width:"100%"},children:e.jsxs(o,{container:!0,direction:"column",children:[Object.keys(h).filter(l=>!h[l].hide).map(l=>e.jsx(y,{id:l,label:h[l].label,disabled:h[l].disabled,name:l,value:d.values[l],onChange:d.handleChange,onBlur:d.handleBlur,variant:"standard",type:"text",sx:{mb:a.spacing(2)},error:d.touched[l]&&!!d.errors[l],helperText:d.touched[l]&&d.errors[l]},l)),e.jsxs(o,{container:!0,sx:{mt:a.spacing(4)},justifyContent:"end",children:[e.jsx(j,{id:"cancel",variant:"outlined",color:"secondary",sx:{mr:a.spacing(2)},onClick:()=>{d.dirty?x(!0):t("/")},disabled:n,children:"Cancel"}),e.jsxs(j,{id:"save",variant:"contained",type:"submit",disabled:!0,children:[n&&e.jsx(H,{color:"secondary",size:24,sx:{mr:a.spacing(2)}}),"Save"]})]})]})})]})]})}),e.jsx(V,{modalOpen:g,setModalOpen:x}),e.jsx(z,{modalOpen:p,setModalOpen:c})]})};export{K as UserDetails,K as default};
